# 2-3. FastAPI 수신 서버 + 시뮬레이터 구현 요약

## 목표
- Jetson 추론 결과를 서버에서 수신/저장/조회할 수 있게 만들고,
- Jetson 없이도 모의 이벤트로 테스트 가능하게 구성.

## 구현 파일
- `src/api/main.py`
- `src/sim/send_mock_danger_event.py`
- `.gitignore`

## 핵심 구현 방식
1. 위험 이벤트 수신 API
- `POST /events/danger` 구현.
- `DangerEvent` 구조로 입력 검증.

2. 로그 저장
- 수신 이벤트를 JSONL 파일로 저장:
  - `data/events/danger_events.jsonl`
- 응답 결과도 별도 JSONL로 저장:
  - `data/events/danger_responses.jsonl`

3. 조회 API
- `GET /events/recent`:
  - 최근 이벤트/응답 메모리 캐시 조회.
- `GET /events/{event_id}/response`:
  - 특정 이벤트 응답 조회.

4. 모의 테스트 스크립트
- `send_mock_danger_event.py`로 반복 POST 테스트:
  - `--count`, `--interval`, `--timeout` 인자 지원.

## 테스트 방법
```bash
source sentinelhybrid-venv/bin/activate
uvicorn src.api.main:app --host 0.0.0.0 --port 8000 --reload
python src/sim/send_mock_danger_event.py --count 5 --interval 2 --timeout 12
```

## 결과
- Jetson이 없어도 서버 파이프라인(수신/저장/조회) 검증 가능.
- 후속 RAG/LLM 파이프라인 연결의 기반 마련.

